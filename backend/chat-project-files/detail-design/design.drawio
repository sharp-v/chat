<mxfile host="65bd71144e">
    <diagram id="qvEY5ux_2ClT5u5ccPfD" name="第 1 页">
        <mxGraphModel dx="2914" dy="722" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1500" pageHeight="1500" background="#F4F1DE" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="LYCqAFSnhNbKchDuzye8-162" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#E07A5F;align=center;fontColor=#393C56;labelBackgroundColor=#F4F1DE;curved=1;" parent="1" source="111" target="10" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-596" y="437"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-163" value="update message state" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="LYCqAFSnhNbKchDuzye8-162" vertex="1" connectable="0">
                    <mxGeometry x="0.1907" y="-2" relative="1" as="geometry">
                        <mxPoint x="-14" y="-4" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="112" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#E07A5F;fontColor=#393C56;labelBackgroundColor=#F4F1DE;curved=1;" parent="1" source="3" target="111" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-504" y="337"/>
                            <mxPoint x="-504" y="337"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="118" value="messages &lt;br&gt;&amp;amp;&amp;nbsp;user" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="112" vertex="1" connectable="0">
                    <mxGeometry x="0.3516" y="1" relative="1" as="geometry">
                        <mxPoint x="19" y="-1" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="121" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;strokeColor=#E07A5F;fontColor=#393C56;labelBackgroundColor=#F4F1DE;curved=1;" parent="1" source="3" target="111" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-427" y="397"/>
                            <mxPoint x="-596" y="397"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="122" value="revoke | close" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="121" vertex="1" connectable="0">
                    <mxGeometry x="0.2277" y="4" relative="1" as="geometry">
                        <mxPoint x="24" y="-2" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="126" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#E07A5F;dashed=1;fontColor=#393C56;labelBackgroundColor=#F4F1DE;curved=1;" parent="1" source="3" target="10" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-427" y="437"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="127" value="messages" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="126" vertex="1" connectable="0">
                    <mxGeometry x="-0.1223" y="-1" relative="1" as="geometry">
                        <mxPoint x="37" y="-2" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="3" value="message" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#F2CC8F;strokeColor=#E07A5F;fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-451" y="297" width="80" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-159" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#E07A5F;align=center;fontColor=#393C56;labelBackgroundColor=#F4F1DE;curved=1;" parent="1" source="4" target="3" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="-559" y="349" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="-395" y="457"/>
                            <mxPoint x="-395" y="457"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-161" value="messages &lt;br&gt;&amp;amp; user" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];rotation=90;fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="LYCqAFSnhNbKchDuzye8-159" vertex="1" connectable="0">
                    <mxGeometry x="-0.1967" y="-1" relative="1" as="geometry">
                        <mxPoint x="12" y="-13" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-192" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#E07A5F;align=center;fontColor=#393C56;labelBackgroundColor=#F4F1DE;curved=1;" parent="1" source="4" target="3" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="-558" y="328" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="-411" y="657"/>
                            <mxPoint x="-301" y="657"/>
                            <mxPoint x="-301" y="337"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-193" value="close" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="LYCqAFSnhNbKchDuzye8-192" vertex="1" connectable="0">
                    <mxGeometry x="0.681" y="3" relative="1" as="geometry">
                        <mxPoint x="-3" y="64" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-198" value="close" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="LYCqAFSnhNbKchDuzye8-192" vertex="1" connectable="0">
                    <mxGeometry x="-0.3757" y="1" relative="1" as="geometry">
                        <mxPoint x="4" y="-169" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="4" value="user" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#F2CC8F;strokeColor=#E07A5F;fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-451" y="511" width="80" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="25" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;shape=flexArrow;startArrow=block;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#E07A5F;align=center;fontColor=#393C56;labelBackgroundColor=#F4F1DE;curved=1;" parent="1" source="7" target="11" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points"/>
                        <mxPoint x="-1051" y="333" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="27" value="websocket" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="25" vertex="1" connectable="0">
                    <mxGeometry x="-0.1912" relative="1" as="geometry">
                        <mxPoint x="10" y="-11" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="7" value="" style="aspect=fixed;html=1;points=[];align=center;image;fontSize=12;image=img/lib/azure2/app_services/API_Management_Services.svg;fillColor=#F2CC8F;strokeColor=#E07A5F;fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-1278" y="310" width="58.5" height="54" as="geometry"/>
                </mxCell>
                <mxCell id="8" value="/api/chat" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-1291.25" y="273" width="85" height="42" as="geometry"/>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-138" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#E07A5F;align=center;fontColor=#393C56;labelBackgroundColor=#F4F1DE;curved=1;" parent="1" source="10" target="5" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-610" y="468"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-148" value="get relation" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="LYCqAFSnhNbKchDuzye8-138" vertex="1" connectable="0">
                    <mxGeometry x="-0.6084" y="-4" relative="1" as="geometry">
                        <mxPoint x="29" y="-4" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-170" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#E07A5F;align=center;fontColor=#393C56;labelBackgroundColor=#F4F1DE;curved=1;" parent="1" source="10" target="11" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-810" y="337"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-171" value="send message" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="LYCqAFSnhNbKchDuzye8-170" vertex="1" connectable="0">
                    <mxGeometry x="0.0182" y="1" relative="1" as="geometry">
                        <mxPoint x="-24" y="-11" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="10" value="&lt;font&gt;database&lt;/font&gt;" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#F2CC8F;strokeColor=#E07A5F;fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-840" y="412" width="60" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="61" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#E07A5F;align=center;fontColor=#393C56;labelBackgroundColor=#F4F1DE;curved=1;" parent="1" source="11" target="111" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="-462" y="467" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="-998" y="244"/>
                            <mxPoint x="-596" y="244"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="62" value="websocket heart beat" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="61" vertex="1" connectable="0">
                    <mxGeometry x="-0.6743" y="-1" relative="1" as="geometry">
                        <mxPoint x="167" y="-1" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-135" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;strokeColor=#E07A5F;align=center;fontColor=#393C56;labelBackgroundColor=#F4F1DE;curved=1;" parent="1" source="11" target="10" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-983" y="452"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-137" value="first connect" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="LYCqAFSnhNbKchDuzye8-135" vertex="1" connectable="0">
                    <mxGeometry x="-0.7737" relative="1" as="geometry">
                        <mxPoint x="61" y="51" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="11" value="&lt;font&gt;on message&lt;/font&gt;" style="whiteSpace=wrap;html=1;fillColor=#F2CC8F;strokeColor=#E07A5F;fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-1039.75" y="298" width="83" height="78" as="geometry"/>
                </mxCell>
                <mxCell id="64" value="&lt;font style=&quot;font-size: 18px&quot;&gt;Chat-backend&lt;br&gt;&lt;br&gt;api: /api/chat &amp;amp; /api/tochat&lt;br&gt;&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size: 14px&quot;&gt;author:__Sharp__&lt;br&gt;email:2742340771@qq.com&lt;/font&gt;" style="whiteSpace=wrap;html=1;fillColor=#F2CC8F;strokeColor=#E07A5F;fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-1242" y="57" width="322" height="140" as="geometry"/>
                </mxCell>
                <mxCell id="65" value="&lt;h1&gt;&lt;font&gt;图释&lt;/font&gt;&lt;/h1&gt;&lt;div&gt;&lt;font&gt;箭头：&lt;/font&gt;&lt;/div&gt;&lt;p&gt;&lt;font&gt;1. 双向箭头表示一个客户端的websocket连接，连接api:/api/chat&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font&gt;2. 单向实箭头表示服务器接收的客户端发来的数据，以及处理要求&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font&gt;3.单向虚箭头表示服务器内部逻辑处理和数据转移&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font&gt;4. 箭头携带文字是对处理或数据的说明&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font&gt;图标：&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font&gt;1. 云图标：指服务器暴露的api&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font&gt;2. 圆角矩形：触发事件&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font&gt;3. 圆柱体：数据库&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font&gt;4. 圆形：用redis存储的数据&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font&gt;&lt;br&gt;&lt;/font&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;labelBackgroundColor=none;fontColor=#393C56;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-488" y="737" width="190" height="410" as="geometry"/>
                </mxCell>
                <mxCell id="67" value="&lt;h1&gt;Redis存储&lt;/h1&gt;&lt;h1&gt;数据结构说明：&lt;/h1&gt;&lt;div&gt;user:&lt;/div&gt;&lt;div&gt;map&amp;lt;id,user&amp;gt;&lt;/div&gt;&lt;div&gt;id : user.id,&lt;span&gt;&#9;&lt;/span&gt;具体格式 ：&quot;uid&quot;+id&lt;/div&gt;&lt;div&gt;user : {&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;id(int),&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;state(int),//0 离线，&amp;gt;0 在线&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;lastConnect(date),&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;...，//其他项待定&lt;/div&gt;&lt;div&gt;}&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;relation:&lt;/div&gt;&lt;div&gt;map&amp;lt;id,relation[]&amp;gt;&lt;/div&gt;&lt;div&gt;id : relation.userId,具体格式：&quot;ruid&quot;+id&lt;/div&gt;&lt;/div&gt;&lt;div&gt;relation[] : [&lt;/div&gt;&lt;div&gt;&lt;span&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;...relation:{},&lt;br&gt;&lt;/div&gt;&lt;div&gt;]&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;message：&lt;/div&gt;&lt;div&gt;map&amp;lt;id,message&amp;gt;&lt;/div&gt;&lt;div&gt;id :message.id 具体格式：&quot;mid&quot;+message.id&lt;/div&gt;&lt;div&gt;message:{&lt;/div&gt;&lt;div&gt;&lt;span&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;id,// message.id&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;sendId,&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;receiveId,&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;content,&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;sendType,&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;url,&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;type,&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;messageState:&lt;/div&gt;&lt;div&gt;map&amp;lt;id,message&amp;gt;&lt;/div&gt;&lt;div&gt;id:user.id, 格式: 'msuid'+user.id&lt;/div&gt;&lt;div&gt;messageState:[&lt;/div&gt;&lt;div&gt;&lt;span&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;...{&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;id,// 状态消息表中的id&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;state,// 信息的状态&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&#9;&lt;/span&gt;messageId,信息的id&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;}&lt;/div&gt;&lt;div&gt;]&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;labelBackgroundColor=none;fontColor=#393C56;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-734" y="737" width="224" height="686" as="geometry"/>
                </mxCell>
                <mxCell id="109" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;entryX=1;entryY=0;entryDx=0;entryDy=0;strokeColor=#E07A5F;fontColor=#393C56;labelBackgroundColor=#F4F1DE;curved=1;" parent="1" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="-563.4228355337245" y="763.4228355337245" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="-996" y="544"/>
                            <mxPoint x="-564" y="544"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="110" value="2.1&amp;nbsp; websocket heart beat" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=none;fontColor=#393C56;rounded=1;" parent="109" vertex="1" connectable="0">
                    <mxGeometry x="-0.6743" y="-1" relative="1" as="geometry">
                        <mxPoint x="187" y="-13" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-124" value="" style="aspect=fixed;html=1;points=[];align=center;image;fontSize=12;image=img/lib/azure2/app_services/API_Management_Services.svg;fillColor=#F2CC8F;strokeColor=#E07A5F;fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-1282" y="563" width="58.5" height="54" as="geometry"/>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-125" value="/api/tochat" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-1291.25" y="530" width="85" height="42" as="geometry"/>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-126" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;shape=flexArrow;startArrow=block;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#E07A5F;align=center;fontColor=#393C56;labelBackgroundColor=#F4F1DE;curved=1;" parent="1" source="LYCqAFSnhNbKchDuzye8-124" target="LYCqAFSnhNbKchDuzye8-140" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points"/>
                        <mxPoint x="-1219.5" y="590" as="sourcePoint"/>
                        <mxPoint x="-1039.75" y="590" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-127" value="websocket" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="LYCqAFSnhNbKchDuzye8-126" vertex="1" connectable="0">
                    <mxGeometry x="-0.1912" relative="1" as="geometry">
                        <mxPoint x="15" y="-12" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-156" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;entryPerimeter=0;dashed=1;strokeColor=#E07A5F;align=center;fontColor=#393C56;labelBackgroundColor=#F4F1DE;curved=1;" parent="1" source="5" target="10" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-157" value="message" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="LYCqAFSnhNbKchDuzye8-156" vertex="1" connectable="0">
                    <mxGeometry x="-0.6567" y="3" relative="1" as="geometry">
                        <mxPoint x="-61" y="-4" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-158" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#E07A5F;align=center;fontColor=#393C56;labelBackgroundColor=#F4F1DE;curved=1;" parent="1" source="5" target="4" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="-424" y="477" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="-587" y="471"/>
                            <mxPoint x="-425" y="471"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-160" value="messages" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="LYCqAFSnhNbKchDuzye8-158" vertex="1" connectable="0">
                    <mxGeometry x="-0.2765" y="-2" relative="1" as="geometry">
                        <mxPoint x="29" y="-2" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-189" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#E07A5F;align=center;fontColor=#393C56;labelBackgroundColor=#F4F1DE;curved=1;" parent="1" source="5" target="4" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="-404" y="581" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="-596" y="656"/>
                            <mxPoint x="-411" y="656"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-191" value="close" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="LYCqAFSnhNbKchDuzye8-189" vertex="1" connectable="0">
                    <mxGeometry x="-0.3836" y="2" relative="1" as="geometry">
                        <mxPoint x="62" y="-4" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="5" value="relation" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#F2CC8F;strokeColor=#E07A5F;fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-636" y="511" width="80" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-146" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#E07A5F;align=center;fontColor=#393C56;labelBackgroundColor=#F4F1DE;curved=1;" parent="1" source="LYCqAFSnhNbKchDuzye8-140" target="5" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-779" y="586"/>
                            <mxPoint x="-779" y="586"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-147" value="send message" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="LYCqAFSnhNbKchDuzye8-146" vertex="1" connectable="0">
                    <mxGeometry x="-0.7579" y="-1" relative="1" as="geometry">
                        <mxPoint x="107" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-149" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;strokeColor=#E07A5F;align=center;fontColor=#393C56;labelBackgroundColor=#F4F1DE;curved=1;" parent="1" source="LYCqAFSnhNbKchDuzye8-140" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="-1026.275883115571" y="630.2413793103449" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="-998" y="680"/>
                            <mxPoint x="-1026" y="680"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-150" value="check" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="LYCqAFSnhNbKchDuzye8-149" vertex="1" connectable="0">
                    <mxGeometry x="0.3548" y="1" relative="1" as="geometry">
                        <mxPoint x="13" y="6" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-188" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=1;exitDx=0;exitDy=0;strokeColor=#E07A5F;align=center;fontColor=#393C56;labelBackgroundColor=#F4F1DE;curved=1;" parent="1" source="LYCqAFSnhNbKchDuzye8-140" target="5" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="-605" y="591" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="-977" y="655"/>
                            <mxPoint x="-596" y="655"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-190" value="close" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="LYCqAFSnhNbKchDuzye8-188" vertex="1" connectable="0">
                    <mxGeometry x="-0.1098" y="-3" relative="1" as="geometry">
                        <mxPoint x="10" y="-4" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-194" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=1;exitDx=0;exitDy=0;strokeColor=#E07A5F;align=center;fontColor=#393C56;labelBackgroundColor=#F4F1DE;curved=1;" parent="1" source="LYCqAFSnhNbKchDuzye8-140" target="3" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-977" y="685"/>
                            <mxPoint x="-266" y="685"/>
                            <mxPoint x="-266" y="337"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-195" value="revoke" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="LYCqAFSnhNbKchDuzye8-194" vertex="1" connectable="0">
                    <mxGeometry x="-0.5438" y="-1" relative="1" as="geometry">
                        <mxPoint x="156" y="4" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-197" value="revoke" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="LYCqAFSnhNbKchDuzye8-194" vertex="1" connectable="0">
                    <mxGeometry x="0.7842" y="-1" relative="1" as="geometry">
                        <mxPoint x="-5" y="39" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-140" value="&lt;font&gt;on message&lt;/font&gt;" style="whiteSpace=wrap;html=1;fillColor=#F2CC8F;strokeColor=#E07A5F;fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-1039.75" y="551" width="83" height="78" as="geometry"/>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-151" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.147;entryY=1.017;entryDx=0;entryDy=0;entryPerimeter=0;strokeColor=#E07A5F;align=center;fontColor=#393C56;labelBackgroundColor=#F4F1DE;curved=1;" parent="1" source="11" target="11" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-998" y="426"/>
                            <mxPoint x="-1028" y="426"/>
                            <mxPoint x="-1028" y="396"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-152" value="check" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="LYCqAFSnhNbKchDuzye8-151" vertex="1" connectable="0">
                    <mxGeometry x="0.6512" y="1" relative="1" as="geometry">
                        <mxPoint x="14" y="24" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-178" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#E07A5F;align=center;fontColor=#393C56;labelBackgroundColor=#F4F1DE;curved=1;" parent="1" source="3" target="3" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-265" y="337"/>
                            <mxPoint x="-265" y="241"/>
                            <mxPoint x="-395" y="241"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-179" value="check message time&lt;br&gt;when userid send message" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="LYCqAFSnhNbKchDuzye8-178" vertex="1" connectable="0">
                    <mxGeometry x="-0.1702" relative="1" as="geometry">
                        <mxPoint x="-33" y="7" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-181" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#E07A5F;align=center;fontColor=#393C56;labelBackgroundColor=#F4F1DE;curved=1;" parent="1" source="5" target="5" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-514" y="606"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-182" value="check relation time&lt;br&gt;when a day after" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="LYCqAFSnhNbKchDuzye8-181" vertex="1" connectable="0">
                    <mxGeometry x="-0.2643" y="1" relative="1" as="geometry">
                        <mxPoint x="19" y="2" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-199" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#E07A5F;align=center;fontColor=#393C56;labelBackgroundColor=#F4F1DE;curved=1;" parent="1" source="4" target="4" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-332" y="619"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="LYCqAFSnhNbKchDuzye8-200" value="clear user time out&lt;br&gt;when user send heart beat" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="LYCqAFSnhNbKchDuzye8-199" vertex="1" connectable="0">
                    <mxGeometry x="-0.2649" y="-1" relative="1" as="geometry">
                        <mxPoint x="12" y="-24" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="sEZCvPqlqGk9M8UKPDAH-110" value="&lt;h1&gt;API说明&lt;/h1&gt;&lt;h1&gt;/api/tochat：&lt;/h1&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;文字说明：&lt;/div&gt;&lt;div&gt;该api用于接收用户关于chat相关的服务，如撤回消息，发送消息，返回服务器执行结果&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;数据参数：&lt;/div&gt;&lt;div&gt;@param&lt;/div&gt;&lt;div&gt;data:{&lt;/div&gt;&lt;div&gt;token,//用于检测用户是谁&lt;/div&gt;&lt;div&gt;type,&lt;/div&gt;&lt;div&gt;/* type:{&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;// type 服务器任务类型&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;“SEND&quot;,//发送消息&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&quot;REVOKE&quot;,//撤回消息&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&quot;CLOSE&quot;,// 回收服务器内存&lt;br&gt;&lt;/div&gt;&lt;div&gt;}*/&lt;/div&gt;&lt;div&gt;messages,// array 撤回和发送时有效&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;@returns&lt;/div&gt;&lt;div&gt;{&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;success,// boolean 是否执行成功&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;message,// 附加文字&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;code,// 错误码，这个暂时待定&lt;br&gt;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;labelBackgroundColor=none;fontColor=#393C56;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-979.75" y="737" width="215" height="522" as="geometry"/>
                </mxCell>
                <mxCell id="sEZCvPqlqGk9M8UKPDAH-111" value="&lt;h1&gt;API说明&lt;/h1&gt;&lt;h1&gt;/api/chat：&lt;/h1&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;文字说明：&lt;/div&gt;&lt;div&gt;该api用于接收客户端的websocket心跳，检测用户是谁，然后将message数据传给用户&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;数据参数：&lt;/div&gt;&lt;div&gt;@param&lt;/div&gt;&lt;div&gt;data : {&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;token, // token用于检测用户是谁&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;type,&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;/* type ：{&lt;/div&gt;&lt;div&gt;&lt;span&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;/span&gt;// type 有两种类型&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&#9;&lt;/span&gt;&quot;OPEN&quot;, //首次连接时&lt;/div&gt;&lt;div&gt;&lt;span&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;/span&gt;&quot;HEARTBEAT&quot; ,// 连接后&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;}*/&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;@returns&amp;nbsp;&lt;/div&gt;&lt;div&gt;Array&amp;nbsp;&lt;span&gt;messages[]&amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;之所以将其和/api/chat分开，是因为两者的返回数据不同，/api/chat返回messages[],而/api/tochat，是返回服务器执行结果&lt;br&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;labelBackgroundColor=none;fontColor=#393C56;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-1242" y="737" width="215" height="485" as="geometry"/>
                </mxCell>
                <mxCell id="113" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#E07A5F;fontColor=#393C56;labelBackgroundColor=#F4F1DE;curved=1;" parent="1" source="111" target="3" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-596" y="243"/>
                            <mxPoint x="-427" y="243"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="117" value="get messages" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="113" vertex="1" connectable="0">
                    <mxGeometry x="-0.136" y="1" relative="1" as="geometry">
                        <mxPoint x="19" y="-7" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="114" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#E07A5F;fontColor=#393C56;labelBackgroundColor=#F4F1DE;curved=1;" parent="1" source="111" target="11" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="-955" y="337" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="-877" y="337"/>
                            <mxPoint x="-877" y="337"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="111" value="message&lt;br&gt;State" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#F2CC8F;strokeColor=#E07A5F;fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="1" vertex="1">
                    <mxGeometry x="-636" y="297" width="80" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="119" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;dashed=1;fontColor=#393C56;labelBackgroundColor=#F4F1DE;strokeColor=#E07A5F;curved=1;" parent="1" source="5" target="5" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="123" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#E07A5F;fontColor=#393C56;labelBackgroundColor=#F4F1DE;curved=1;" parent="1" source="111" target="111" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-596" y="397"/>
                            <mxPoint x="-671" y="397"/>
                            <mxPoint x="-671" y="337"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="124" value="check state&lt;br&gt;when websocket&amp;nbsp;&lt;br&gt;heart beat" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#393C56;labelBackgroundColor=#F4F1DE;rounded=1;" parent="123" vertex="1" connectable="0">
                    <mxGeometry x="0.1041" y="-2" relative="1" as="geometry">
                        <mxPoint x="-11" y="-17" as="offset"/>
                    </mxGeometry>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
    <diagram id="QuB7IlWDPYy-fq-AiWZf" name="第 2 页 旧版设计">
        <mxGraphModel dx="2490" dy="575" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1500" pageHeight="1400" math="0" shadow="0">
            <root>
                <mxCell id="yXDzxxeLLf4dSOkhg7sl-0"/>
                <mxCell id="yXDzxxeLLf4dSOkhg7sl-1" parent="yXDzxxeLLf4dSOkhg7sl-0"/>
                <mxCell id="PP6jbf_EtGjdo3r5b2O1-0" value="&lt;h1&gt;数据结构说明：&lt;/h1&gt;&lt;div&gt;user:&lt;/div&gt;&lt;div&gt;map&amp;lt;id,user&amp;gt;&lt;/div&gt;&lt;div&gt;id : user.id,&lt;span&gt;&#9;&lt;/span&gt;具体格式 ：&quot;uid&quot;+id&lt;/div&gt;&lt;div&gt;user : {&lt;/div&gt;&lt;div&gt;id(int),&lt;/div&gt;&lt;div&gt;state(int),//0 离线，&amp;gt;0 在线&lt;/div&gt;&lt;div&gt;lastConnect(date),&lt;/div&gt;&lt;div&gt;}&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;relation:&lt;/div&gt;&lt;div&gt;map&amp;lt;id,relation[]&amp;gt;&lt;/div&gt;&lt;div&gt;id : relation.userId,具体格式：&quot;ruid&quot;+id&lt;/div&gt;&lt;/div&gt;&lt;div&gt;relation[] : [&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;...relation:{},&lt;br&gt;&lt;/div&gt;&lt;div&gt;]&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;message：&lt;/div&gt;&lt;div&gt;map&amp;lt;id,message[]&amp;gt;&lt;/div&gt;&lt;div&gt;id : receiveId 具体格式：&quot;mrid&quot;+id&lt;/div&gt;&lt;div&gt;message[] : [&lt;/div&gt;&lt;div&gt;&lt;span&gt;&#9;&lt;/span&gt;...message:{},&lt;/div&gt;&lt;div&gt;],message数组&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" parent="yXDzxxeLLf4dSOkhg7sl-1" vertex="1">
                    <mxGeometry x="-1471" y="454" width="215" height="378" as="geometry"/>
                </mxCell>
                <mxCell id="C2Bu8ao-GzHpZrlyDZIK-0" value="&lt;h1&gt;&lt;font color=&quot;#ffffff&quot;&gt;注释&lt;/font&gt;&lt;/h1&gt;&lt;p&gt;&lt;font color=&quot;#ffffff&quot;&gt;1. 双向箭头表示一个客户端的websocket连接，连接api:/api/chat&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font color=&quot;#ffffff&quot;&gt;2. 单向实箭头表示服务器接收的客户端发来的数据，以及处理要求&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font color=&quot;#ffffff&quot;&gt;3.单向虚箭头表示服务器内部逻辑处理和数据转移&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font color=&quot;#ffffff&quot;&gt;4. 箭头携带文字是对处理或数据的说明&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font color=&quot;#ffffff&quot;&gt;5. 携带文字最前的数字说明：&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font color=&quot;#ffffff&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;1.0 表示建立websocket要做的事件 'OPEN'&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font color=&quot;#ffffff&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;2.0表示websocket建立后接收用户的数据消息 'SEND'&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font color=&quot;#ffffff&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;2.1 表示websocket心跳，用于及时将消息转发给用户 'HEARTBEAT'&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font color=&quot;#ffffff&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;在这些后面是它们的中间处理过程&lt;/font&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;labelBackgroundColor=none;" parent="yXDzxxeLLf4dSOkhg7sl-1" vertex="1">
                    <mxGeometry x="-1471" y="33" width="190" height="410" as="geometry"/>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-0" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;startArrow=none;startFill=0;" parent="yXDzxxeLLf4dSOkhg7sl-1" source="BbVNVAn00UFCB4R-QdmP-6" target="BbVNVAn00UFCB4R-QdmP-24" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="-1052" y="360" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="-666" y="462"/>
                            <mxPoint x="-1052" y="462"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-1" value="2.2 update messasge state" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=none;" parent="BbVNVAn00UFCB4R-QdmP-0" vertex="1" connectable="0">
                    <mxGeometry x="0.1484" relative="1" as="geometry">
                        <mxPoint x="-4" y="10" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-2" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;" parent="yXDzxxeLLf4dSOkhg7sl-1" source="BbVNVAn00UFCB4R-QdmP-6" target="BbVNVAn00UFCB4R-QdmP-35" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-666" y="98"/>
                            <mxPoint x="-1059" y="98"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-3" value="2.1.1&lt;br&gt;send message[]&amp;nbsp;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=none;" parent="BbVNVAn00UFCB4R-QdmP-2" vertex="1" connectable="0">
                    <mxGeometry x="-0.6109" y="-2" relative="1" as="geometry">
                        <mxPoint x="-45" y="48" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-4" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=1;entryY=0;entryDx=0;entryDy=0;dashed=1;" parent="yXDzxxeLLf4dSOkhg7sl-1" source="BbVNVAn00UFCB4R-QdmP-6" target="BbVNVAn00UFCB4R-QdmP-9" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-666" y="138"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-5" value="2.1.2&lt;br&gt;update user state" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=none;" parent="BbVNVAn00UFCB4R-QdmP-4" vertex="1" connectable="0">
                    <mxGeometry x="0.713" y="1" relative="1" as="geometry">
                        <mxPoint x="30" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-6" value="message" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;rounded=0;sketch=0;" parent="yXDzxxeLLf4dSOkhg7sl-1" vertex="1">
                    <mxGeometry x="-706" y="278" width="80" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-7" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1.01;entryY=0.587;entryDx=0;entryDy=0;entryPerimeter=0;dashed=1;startArrow=none;startFill=0;exitX=0.037;exitY=0.691;exitDx=0;exitDy=0;exitPerimeter=0;" parent="yXDzxxeLLf4dSOkhg7sl-1" source="BbVNVAn00UFCB4R-QdmP-9" target="BbVNVAn00UFCB4R-QdmP-24" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-877" y="184"/>
                            <mxPoint x="-879" y="184"/>
                            <mxPoint x="-879" y="183"/>
                            <mxPoint x="-935" y="183"/>
                            <mxPoint x="-935" y="409"/>
                            <mxPoint x="-1021" y="409"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-8" value="2.0.0 &lt;br&gt;set message state" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=none;" parent="BbVNVAn00UFCB4R-QdmP-7" vertex="1" connectable="0">
                    <mxGeometry x="-0.4202" y="-1" relative="1" as="geometry">
                        <mxPoint x="4" y="-26" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-9" value="user" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;rounded=0;sketch=0;" parent="yXDzxxeLLf4dSOkhg7sl-1" vertex="1">
                    <mxGeometry x="-880" y="126" width="80" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-10" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;dashed=1;startArrow=none;startFill=0;" parent="yXDzxxeLLf4dSOkhg7sl-1" source="BbVNVAn00UFCB4R-QdmP-14" target="BbVNVAn00UFCB4R-QdmP-6" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-11" value="2.0.2 &lt;br&gt;new message" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=none;" parent="BbVNVAn00UFCB4R-QdmP-10" vertex="1" connectable="0">
                    <mxGeometry x="-0.6443" relative="1" as="geometry">
                        <mxPoint x="19" y="-9" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-12" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.575;entryDx=0;entryDy=0;entryPerimeter=0;dashed=1;startArrow=none;startFill=0;" parent="yXDzxxeLLf4dSOkhg7sl-1" source="BbVNVAn00UFCB4R-QdmP-14" target="BbVNVAn00UFCB4R-QdmP-24" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-848" y="409"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-13" value="2.0.1.0 &lt;br&gt;set message state" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=none;" parent="BbVNVAn00UFCB4R-QdmP-12" vertex="1" connectable="0">
                    <mxGeometry x="-0.8326" y="1" relative="1" as="geometry">
                        <mxPoint x="-44" y="9" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-14" value="relation" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;rounded=0;sketch=0;" parent="yXDzxxeLLf4dSOkhg7sl-1" vertex="1">
                    <mxGeometry x="-880" y="278" width="80" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-15" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;shape=flexArrow;startArrow=block;" parent="yXDzxxeLLf4dSOkhg7sl-1" source="BbVNVAn00UFCB4R-QdmP-17" target="BbVNVAn00UFCB4R-QdmP-35" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-1136" y="163"/>
                            <mxPoint x="-1136" y="163"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-16" value="websocket" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=none;" parent="BbVNVAn00UFCB4R-QdmP-15" vertex="1" connectable="0">
                    <mxGeometry x="-0.1912" relative="1" as="geometry">
                        <mxPoint x="10" y="-11" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-17" value="" style="aspect=fixed;html=1;points=[];align=center;image;fontSize=12;image=img/lib/azure2/app_services/API_Management_Services.svg;rounded=0;sketch=0;" parent="yXDzxxeLLf4dSOkhg7sl-1" vertex="1">
                    <mxGeometry x="-1246" y="136.5" width="58.5" height="54" as="geometry"/>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-18" value="/api/chat" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;sketch=0;" parent="yXDzxxeLLf4dSOkhg7sl-1" vertex="1">
                    <mxGeometry x="-1259.25" y="107" width="85" height="42" as="geometry"/>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-19" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;entryX=0.008;entryY=0.587;entryDx=0;entryDy=0;entryPerimeter=0;" parent="yXDzxxeLLf4dSOkhg7sl-1" source="BbVNVAn00UFCB4R-QdmP-24" target="BbVNVAn00UFCB4R-QdmP-9" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-984" y="395"/>
                            <mxPoint x="-984" y="173"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-20" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;" parent="yXDzxxeLLf4dSOkhg7sl-1" source="BbVNVAn00UFCB4R-QdmP-24" target="BbVNVAn00UFCB4R-QdmP-14" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-826" y="434"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-21" value="1.0.2 user relation" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=none;" parent="BbVNVAn00UFCB4R-QdmP-20" vertex="1" connectable="0">
                    <mxGeometry x="-0.3542" y="-2" relative="1" as="geometry">
                        <mxPoint x="28" y="10" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-22" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;" parent="yXDzxxeLLf4dSOkhg7sl-1" source="BbVNVAn00UFCB4R-QdmP-24" target="BbVNVAn00UFCB4R-QdmP-35" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-1109" y="410"/>
                            <mxPoint x="-1109" y="181"/>
                        </Array>
                        <mxPoint x="-1091" y="179" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-23" value="1.0.3 &lt;br&gt;unread message" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=none;" parent="BbVNVAn00UFCB4R-QdmP-22" vertex="1" connectable="0">
                    <mxGeometry x="0.1289" relative="1" as="geometry">
                        <mxPoint x="-16" y="143" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-24" value="&lt;font color=&quot;#000000&quot;&gt;database&lt;/font&gt;" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;rounded=0;sketch=0;" parent="yXDzxxeLLf4dSOkhg7sl-1" vertex="1">
                    <mxGeometry x="-1082" y="363" width="60" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-25" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="yXDzxxeLLf4dSOkhg7sl-1" source="BbVNVAn00UFCB4R-QdmP-35" target="BbVNVAn00UFCB4R-QdmP-24" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-1068" y="263"/>
                            <mxPoint x="-1068" y="263"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-26" value="1.0 &lt;br&gt;websocket open" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=none;" parent="BbVNVAn00UFCB4R-QdmP-25" vertex="1" connectable="0">
                    <mxGeometry x="-0.1456" y="-2" relative="1" as="geometry">
                        <mxPoint x="-7" y="-57" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-27" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;startArrow=none;startFill=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;" parent="yXDzxxeLLf4dSOkhg7sl-1" source="BbVNVAn00UFCB4R-QdmP-9" target="BbVNVAn00UFCB4R-QdmP-14" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-840" y="249"/>
                            <mxPoint x="-840" y="249"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-28" value="2.0.1 &lt;br&gt;check relation config" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=none;" parent="BbVNVAn00UFCB4R-QdmP-27" vertex="1" connectable="0">
                    <mxGeometry x="-0.354" relative="1" as="geometry">
                        <mxPoint x="-19" y="13" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-29" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=-0.011;entryY=0.471;entryDx=0;entryDy=0;startArrow=none;startFill=0;entryPerimeter=0;" parent="yXDzxxeLLf4dSOkhg7sl-1" source="BbVNVAn00UFCB4R-QdmP-35" target="BbVNVAn00UFCB4R-QdmP-9" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-30" value="2.0&lt;br&gt;check reciveId state" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=none;" parent="BbVNVAn00UFCB4R-QdmP-29" vertex="1" connectable="0">
                    <mxGeometry x="-0.1729" y="-1" relative="1" as="geometry">
                        <mxPoint x="12" y="-16" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-31" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;startArrow=none;startFill=0;entryX=0.672;entryY=0.015;entryDx=0;entryDy=0;entryPerimeter=0;" parent="yXDzxxeLLf4dSOkhg7sl-1" source="BbVNVAn00UFCB4R-QdmP-35" target="BbVNVAn00UFCB4R-QdmP-24" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-1042" y="351"/>
                        </Array>
                        <mxPoint x="-1036" y="361" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-32" value="2.0&amp;nbsp;&lt;br&gt;new message" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=none;" parent="BbVNVAn00UFCB4R-QdmP-31" vertex="1" connectable="0">
                    <mxGeometry x="-0.782" y="-2" relative="1" as="geometry">
                        <mxPoint x="9" y="31" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-33" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;rounded=1;entryX=1;entryY=0;entryDx=0;entryDy=0;" parent="yXDzxxeLLf4dSOkhg7sl-1" source="BbVNVAn00UFCB4R-QdmP-35" target="BbVNVAn00UFCB4R-QdmP-6" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="-632" y="297" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="-1070" y="70"/>
                            <mxPoint x="-638" y="70"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-34" value="2.1&amp;nbsp; websocket heart beat" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=none;" parent="BbVNVAn00UFCB4R-QdmP-33" vertex="1" connectable="0">
                    <mxGeometry x="-0.6743" y="-1" relative="1" as="geometry">
                        <mxPoint x="187" y="-13" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-35" value="&lt;font color=&quot;#000000&quot;&gt;node&lt;br&gt;express&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;sketch=0;" parent="yXDzxxeLLf4dSOkhg7sl-1" vertex="1">
                    <mxGeometry x="-1089" y="139" width="74" height="49" as="geometry"/>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-36" value="1.0.1&amp;nbsp;&lt;br&gt;user state" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;" parent="yXDzxxeLLf4dSOkhg7sl-1" vertex="1">
                    <mxGeometry x="-1038" y="327" width="63" height="32" as="geometry"/>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-37" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;startArrow=none;startFill=0;dashed=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="yXDzxxeLLf4dSOkhg7sl-1" source="BbVNVAn00UFCB4R-QdmP-6" target="BbVNVAn00UFCB4R-QdmP-6" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="-415" y="333" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="-666" y="407"/>
                            <mxPoint x="-772" y="407"/>
                            <mxPoint x="-772" y="343"/>
                        </Array>
                        <mxPoint x="-622" y="359" as="sourcePoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-38" value="2.0.2 &lt;br&gt;new message" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=none;" parent="BbVNVAn00UFCB4R-QdmP-37" vertex="1" connectable="0">
                    <mxGeometry x="0.1437" y="-1" relative="1" as="geometry">
                        <mxPoint x="35" y="-10" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-39" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;startArrow=none;startFill=0;dashed=1;entryX=0.102;entryY=0.192;entryDx=0;entryDy=0;entryPerimeter=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" parent="yXDzxxeLLf4dSOkhg7sl-1" source="BbVNVAn00UFCB4R-QdmP-6" target="BbVNVAn00UFCB4R-QdmP-6" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-666" y="232"/>
                            <mxPoint x="-772" y="232"/>
                            <mxPoint x="-772" y="293"/>
                        </Array>
                        <mxPoint x="-673" y="275" as="sourcePoint"/>
                        <mxPoint x="-681" y="280" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-40" value="2.1.1&lt;br&gt;check userId == receiveId&lt;br&gt;new message" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=none;" parent="BbVNVAn00UFCB4R-QdmP-39" vertex="1" connectable="0">
                    <mxGeometry x="-0.1767" y="2" relative="1" as="geometry">
                        <mxPoint x="32" y="21" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-41" value="Chat-backend&lt;br&gt;&lt;br&gt;api: /api/chat&lt;br&gt;author:__Sharp__&lt;br&gt;email:2742340771@qq.com" style="rounded=1;whiteSpace=wrap;html=1;labelBackgroundColor=none;" parent="yXDzxxeLLf4dSOkhg7sl-1" vertex="1">
                    <mxGeometry x="-1271" y="14" width="174" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-42" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=1;entryDx=0;entryDy=0;" parent="yXDzxxeLLf4dSOkhg7sl-1" source="BbVNVAn00UFCB4R-QdmP-9" target="BbVNVAn00UFCB4R-QdmP-9" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-759" y="160"/>
                            <mxPoint x="-759" y="194"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-43" value="recycle time" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="BbVNVAn00UFCB4R-QdmP-42" vertex="1" connectable="0">
                    <mxGeometry x="0.1692" relative="1" as="geometry">
                        <mxPoint x="4" y="-18" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-44" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="yXDzxxeLLf4dSOkhg7sl-1" source="BbVNVAn00UFCB4R-QdmP-6" target="BbVNVAn00UFCB4R-QdmP-6" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-608" y="318"/>
                            <mxPoint x="-608" y="380"/>
                            <mxPoint x="-654" y="380"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-45" value="recycle time" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="BbVNVAn00UFCB4R-QdmP-44" vertex="1" connectable="0">
                    <mxGeometry x="0.1521" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-46" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="yXDzxxeLLf4dSOkhg7sl-1" source="BbVNVAn00UFCB4R-QdmP-14" target="BbVNVAn00UFCB4R-QdmP-14" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-911" y="290"/>
                            <mxPoint x="-911" y="318"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="BbVNVAn00UFCB4R-QdmP-47" value="recycle time" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="BbVNVAn00UFCB4R-QdmP-46" vertex="1" connectable="0">
                    <mxGeometry x="-0.6887" y="1" relative="1" as="geometry">
                        <mxPoint x="-18" y="11" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="oQiVFrNwrHpKjxtSsXWV-1" value="&lt;h1&gt;设计问题&lt;/h1&gt;&lt;p&gt;让所有关于消息的内容都交给/api/chat来完成&lt;/p&gt;&lt;p&gt;这会使/api/chat过于臃肿。。。&lt;/p&gt;&lt;p&gt;返回的数据也要进行分类&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;api设计应该有个规范：&lt;/p&gt;&lt;p&gt;一个api只返回一种特定业务的数据&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" parent="yXDzxxeLLf4dSOkhg7sl-1" vertex="1">
                    <mxGeometry x="-1140" y="610" width="207" height="240" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>