{"version":3,"sources":["webpack:///./src/views/profile/childRoute/UserInfo.vue?3810","webpack:///./src/views/profile/childRoute/UserInfo.vue","webpack:///./src/service/http/upload/index.js","webpack:///./src/views/profile/childRoute/UserInfo.vue?f4a4"],"names":["class","title","left-text","left-arrow","$router","go","right","name","size","inset","label","input","avatarFile","after-read","afterReadAvatar","backImageFile","afterReadBackImage","user","nickName","sign","type","phone","email","round","block","native-type","submit","id","readonly","account","url","childRoute","uploadAvatar","fileData","formData","FormData","append","postFile","then","res","console","log","code","value","default","success","data","Notify","uploadBackImage","setup","createdAt","updatedAt","avatar","backImage","file","path","deletable","imageFit","previewSize","computed","access","state","current","methods","this","flag","profile","key","mounted","$route","getProfile","getAvatar","getBackImage","render","__scopeId"],"mappings":"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","file":"js/chunk-73b8da90.0933b1af.js","sourcesContent":["export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./UserInfo.vue?vue&type=style&index=0&id=4d2f8f5f&scoped=true&lang=css\"","<template>\r\n  <div class=\"user-info child-route\">\r\n    <van-nav-bar\r\n      title=\"我的账户\"\r\n      left-text=\"返回\"\r\n      left-arrow\r\n      @click-left=\"$router.go(-1)\"\r\n      class=\"nav-bar\"\r\n    >\r\n      <template #right>\r\n        <van-icon name=\"more\" size=\"24\" />\r\n      </template>\r\n    </van-nav-bar>\r\n    <div class=\"info-items main\">\r\n      <van-cell-group inset title=\"可修改项：\">\r\n        <van-field label=\"头像\">\r\n          <template #input>\r\n            <van-uploader v-model=\"avatarFile\" :after-read=\"afterReadAvatar\" />\r\n          </template> </van-field\r\n        ><van-field label=\"背景图\">\r\n          <template #input>\r\n            <van-uploader\r\n              v-model=\"backImageFile\"\r\n              :after-read=\"afterReadBackImage\"\r\n            />\r\n          </template>\r\n        </van-field>\r\n        <van-field v-model=\"user.nickName\" label=\"昵称\" />\r\n        <van-field v-model=\"user.sign\" type=\"text\" label=\"签名\" />\r\n        <van-field v-model=\"user.phone\" type=\"tel\" label=\"手机号\" />\r\n        <van-field v-model=\"user.email\" type=\"text\" label=\"邮箱\" />\r\n      </van-cell-group>\r\n      <van-button\r\n        round\r\n        block\r\n        type=\"primary\"\r\n        native-type=\"submit\"\r\n        @click=\"submit\"\r\n      >\r\n        提交\r\n      </van-button>\r\n      <van-cell-group inset title=\"不可修改项：\">\r\n        <van-field v-model=\"user.id\" type=\"text\" label=\"ID\" readonly />\r\n        <van-field v-model=\"user.account\" type=\"text\" label=\"账户\" readonly />\r\n      </van-cell-group>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref } from \"vue\";\r\nimport { mapActions, mapState, mapGetters, mapMutations } from \"vuex\";\r\n\r\nimport {\r\n  uploadAvatar,\r\n  uploadBackImage,\r\n} from \"../../../service/http/upload/index\";\r\nimport { update } from \"../../../service/http/account/index\";\r\nexport default {\r\n  setup() {\r\n    const user = ref({\r\n      id: \"\",\r\n      nickName: \"\",\r\n      phone: \"\",\r\n      account: \"\",\r\n      sign: \"\",\r\n      createdAt: \"\",\r\n      updatedAt: \"\",\r\n      email: \"\",\r\n      avatar: \"\",\r\n      backImage: \"\",\r\n    });\r\n    const afterReadAvatar = (file) => {\r\n      uploadAvatar(file.file).then((path) => {\r\n        user.value.avatar = path;\r\n      });\r\n    };\r\n    const afterReadBackImage = (file) => {\r\n      uploadBackImage(file.file).then((path) => {\r\n        user.value.backImage = path;\r\n      });\r\n    };\r\n    const avatarFile = ref([\r\n      {\r\n        url: \"\",\r\n        deletable: true,\r\n        imageFit: \"cover\",\r\n        previewSize: 120,\r\n      },\r\n    ]);\r\n    const backImageFile = ref([\r\n      {\r\n        url: \"\",\r\n        deletable: true,\r\n        imageFit: \"cover\",\r\n        previewSize: 120,\r\n      },\r\n    ]);\r\n    return {\r\n      user,\r\n      afterReadAvatar,\r\n      afterReadBackImage,\r\n      avatarFile,\r\n      backImageFile,\r\n    };\r\n  },\r\n  computed: {\r\n    ...mapState({\r\n      access: (state) => state.current.user,\r\n    }),\r\n    ...mapGetters([\"getAvatar\", \"getProfile\", \"getBackImage\"]),\r\n  },\r\n  methods: {\r\n    ...mapMutations([\"profile\"]),\r\n    ...mapActions([\"initUserProfile\"]),\r\n    submit() {\r\n      console.log(this.user);\r\n      update(this.user).then((flag) => {\r\n        flag && this.profile({ key: this.access, profile: this.user });\r\n      });\r\n      console.log(this.user);\r\n    },\r\n  },\r\n  mounted() {\r\n    console.log(this.$route);\r\n    this.user = this.getProfile(this.access);\r\n    this.avatarFile[0].url = this.getAvatar(this.access);\r\n    this.backImageFile[0].url = this.getBackImage(this.access);\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.child-route {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100vw;\r\n  height: 100vh;\r\n  overflow-y: scroll;\r\n  scroll-behavior: smooth;\r\n}\r\n.user-info .info-items {\r\n  padding: 50px 0;\r\n  background: #fff;\r\n  height: 120vh;\r\n}\r\n.user-info  .van-cell__title.van-field__label{\r\n  width: 42px;\r\n}\r\n</style>","import { Notify } from \"vant\";\r\nimport { code } from \"../../../common/code\";\r\nimport { postFile } from \"../http-config\";\r\n\r\nfunction url(childRoute) {\r\n  return '/upload' + childRoute\r\n}\r\n\r\nfunction uploadAvatar(fileData) {\r\n  let formData = new FormData()\r\n  formData.append('avatar', fileData)\r\n  return postFile({\r\n    url: url('/avatar')\r\n  }, formData).then(res => {\r\n    console.log(res)\r\n    if (res.code.value == code.default.success.value) {\r\n      return res.data\r\n    } else {\r\n      Notify(res.code)\r\n    }\r\n  })\r\n}\r\n\r\nfunction uploadBackImage(fileData) {\r\n  let formData = new FormData()\r\n  formData.append('backImage', fileData)\r\n  return postFile({\r\n    url: url('/back-image')\r\n  }, formData).then(res => {\r\n    console.log(res)\r\n    if (res.code.value == code.default.success.value) {\r\n      return res.data\r\n    } else {\r\n      Notify(res.code)\r\n    }\r\n  })\r\n}\r\n\r\n\r\nexport {\r\n  uploadAvatar,\r\n  uploadBackImage\r\n}","import { render } from \"./UserInfo.vue?vue&type=template&id=4d2f8f5f&scoped=true\"\nimport script from \"./UserInfo.vue?vue&type=script&lang=js\"\nexport * from \"./UserInfo.vue?vue&type=script&lang=js\"\n\nimport \"./UserInfo.vue?vue&type=style&index=0&id=4d2f8f5f&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-4d2f8f5f\"\n\nexport default script"],"sourceRoot":""}