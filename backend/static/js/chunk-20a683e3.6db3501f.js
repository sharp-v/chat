(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-20a683e3"],{2781:function(e,t,n){},4991:function(e,t,n){"use strict";n("2781")},"4f5a":function(e,t,n){"use strict";n("ff65")},"696f":function(e,t,n){"use strict";n("72d0")},"72d0":function(e,t,n){},"7e7f":function(e,t,n){"use strict";var s=n("7a23");function a(e,t,n,a,c,i){var o=Object(s["J"])("van-image");return Object(s["C"])(),Object(s["g"])(o,{round:"",width:n.size,height:n.size,src:n.avatarLink},null,8,["width","height","src"])}var c={props:{avatarLink:{type:String,default:n("f42b")},size:{type:String,default:"80"}},mounted:function(){}};n("4991");c.render=a,c.__scopeId="data-v-77e4a452";t["a"]=c},ca20:function(e,t,n){"use strict";n.r(t);var s=n("7a23"),a={class:"chat"},c={class:"main"},i={class:"content"},o=Object(s["j"])("svg",{t:"1631719738192",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4493",width:"128",height:"128"},[Object(s["j"])("path",{d:"M511.979978 20.021899C240.362897 20.021899 20.162052 240.222744 20.162052 511.839825s220.200845 491.817926 491.817926 491.817926S1003.797904 783.456906 1003.797904 511.839825 783.617081 20.021899 511.979978 20.021899L511.979978 20.021899zM786.13984 506.333803l0 15.136556L785.999687 521.470358c-2.102299 32.79587-29.392148 58.764273-62.728609 58.764273L580.374785 580.234632l0 205.765056-78.005318 0L502.369467 785.859534c-32.815892-2.122321-58.764273-29.372126-58.764273-62.708588l0-142.916315L237.840138 580.234632l0-78.005318 0.140153 0c2.122321-32.815892 29.372126-58.784295 62.708588-58.784295l142.896293 0 0-142.916315 0-62.868763 78.005318 0 0 0.160175c32.815892 2.102299 58.764273 29.372126 58.764273 62.708588l0 142.916315 205.785077 0L786.13984 506.333803 786.13984 506.333803zM786.13984 506.333803","p-id":"4494",fill:"#1296db"})],-1),r=[o];function u(e,t,n,o,u,d){var l=Object(s["J"])("van-icon"),b=Object(s["J"])("van-nav-bar"),m=Object(s["J"])("message-container"),j=Object(s["J"])("van-field");return Object(s["C"])(),Object(s["i"])("div",a,[Object(s["m"])(b,{title:o.relation?o.relation.remark:"备注","left-text":"返回","left-arrow":"",onClickLeft:t[0]||(t[0]=function(t){return e.$router.go(-1)}),onClickRight:t[1]||(t[1]=function(t){return e.$router.push("/relation-config")}),class:"nav-bar"},{right:Object(s["R"])((function(){return[Object(s["m"])(l,{name:"more",size:"24"})]})),_:1},8,["title"]),Object(s["j"])("div",c,[Object(s["j"])("div",i,[(Object(s["C"])(!0),Object(s["i"])(s["a"],null,Object(s["I"])(e.getMessage(e.access),(function(e,t){return Object(s["C"])(),Object(s["i"])("div",{key:t},[Object(s["m"])(m,{message:d.wrapperMessage(e,t)},null,8,["message"])])})),128))])]),Object(s["m"])(j,{class:"input-message-item blur-bg",modelValue:o.content,"onUpdate:modelValue":[t[4]||(t[4]=function(e){return o.content=e}),t[7]||(t[7]=function(e){return d.update()})],center:"",clearable:"",placeholder:"键盘回车建或点击右侧按钮发送消息",onFocus:t[5]||(t[5]=function(e){return d.focus(e)}),onKeyup:t[6]||(t[6]=Object(s["T"])((function(e){return d.enter()}),["enter"])),onClick:t[8]||(t[8]=function(e){return d.click()})},{button:Object(s["R"])((function(){return[Object(s["j"])("button",{class:"send-message-button",onClick:t[2]||(t[2]=function(){return d.sendMessage&&d.sendMessage.apply(d,arguments)})},"发送")]})),label:Object(s["R"])((function(){return[Object(s["j"])("button",{class:"more-message-button",onClick:t[3]||(t[3]=function(e){return d.more()})},r)]})),_:1},8,["modelValue"])])}var d=n("5530"),l=(n("d81d"),n("b0c0"),n("5502")),b=n("626a"),m=n("a49b");Object(s["F"])("data-v-2c07308e");var j={class:"message-container"},g={class:"time"},f={class:"wrapper-message"},O={class:"text"},h={key:0,class:"message-avatar"},v={class:"content"},p={key:1,class:"message-avatar"},M=Object(s["j"])("br",null,null,-1);function k(e,t,n,a,c,i){var o=Object(s["J"])("avatar");return Object(s["C"])(),Object(s["i"])("div",j,[Object(s["j"])("div",g,Object(s["N"])(e.getMessageTime(e.access,n.message.index)),1),Object(s["j"])("div",f,[Object(s["j"])("div",{class:Object(s["v"])(["name",{right:n.message.isMine}])},[Object(s["j"])("div",O,Object(s["N"])(n.message.isMine?"我":n.message.name),1)],2),Object(s["j"])("div",{class:Object(s["v"])([{isMine:n.message.isMine},"wrapper-content"])},[n.message.isMine?Object(s["h"])("",!0):(Object(s["C"])(),Object(s["i"])("div",h,[Object(s["m"])(o,{size:"36px",avatarLink:e.getAvatar(n.message.senderKey)},null,8,["avatarLink"])])),Object(s["j"])("div",v,Object(s["N"])(n.message.content),1),n.message.isMine?(Object(s["C"])(),Object(s["i"])("div",p,[Object(s["m"])(o,{size:"36px",avatarLink:e.getAvatar(n.message.senderKey)},null,8,["avatarLink"])])):Object(s["h"])("",!0)],2)]),M])}Object(s["D"])();var y=n("7e7f"),w={computed:Object(d["a"])(Object(d["a"])({},Object(l["e"])({access:function(e){return e.current.access}})),Object(l["c"])(["getRelation","getMessage","getProfile","getMessageTime","getAvatar"])),methods:Object(d["a"])({},Object(l["b"])(["initProfile","commitMessage"])),props:{message:{type:Object,default:function(){return{id:-1,state:0,messageId:-1,type:0,name:"",isMine:!1,content:"",url:"",key:{id:"",type:""},index:0}}}},mounted:function(){},components:{Avatar:y["a"]}};n("696f");w.render=k,w.__scopeId="data-v-2c07308e";var C=w,I={name:"chat",setup:function(){var e=Object(s["H"])(0),t=Object(s["H"])(!1),n=Object(s["H"])(0),a=function(){setTimeout((function(){Object(b["a"])("待开发,bug++"),t.value=!1,e.value++}),1e3)},c=Object(s["H"])(),i=Object(s["H"])(""),o=m["g"].TYPE;return{relation:c,content:i,TYPE:o,count:e,loading:t,onRefresh:a,unReadCount:n}},computed:Object(d["a"])(Object(d["a"])({},Object(l["e"])({access:function(e){return e.current.access},map:function(e){return e.message.map},length:function(e){return e.message.map.size}})),Object(l["c"])(["getRelation","getMessage","getProfile","getMessageTime","getUnReadCount"])),methods:Object(d["a"])(Object(d["a"])(Object(d["a"])({},Object(l["d"])(["messageRead","updateActiveList"])),Object(l["b"])(["initProfile","commitMessage","initMessage"])),{},{sendMessage:function(){var e={userId:this.relation.userId,main:{sendId:this.relation.userId,receiveId:this.relation.contactId,sendType:this.relation.type,content:this.content},state:null,createdAt:Date.now()},t=this.access;this.commitMessage({key:t,message:e}),this.content="",this.toBottomSmooth()},getUser:function(e){var t=!1,n=JSON.stringify({id:e.main.sendId,type:m["j"]}),s=this.getRelation(n),a=s?s.remark:null;return t=e.main.sendId==e.userId,{name:a,key:n,isMine:t}},wrapperMessage:function(e,t){var n=this.getUser(e);return{id:e.id,state:e.state,type:e.main.type,name:n.name,isMine:n.isMine,content:e.main.content,sendId:e.main.sendId,url:e.main.url,key:n.key,senderKey:e.senderKey,index:t}},toBottom:function(){window.scrollTo({top:m["d"],behavior:"auto"})},toBottomSmooth:function(){window.scrollTo({top:m["d"],behavior:"smooth"})},focus:function(e){this.toBottomSmooth()},enter:function(){this.sendMessage(),this.toBottomSmooth()},update:function(){},click:function(){this.toBottomSmooth()},more:function(){Object(b["a"])("待开发,目前仅支持发送单行文字消息")}}),mounted:function(){this.initMessage(this.access),this.relation=this.getRelation(this.access),this.toBottom(),this.unReadCount=this.getUnReadCount(this.access)},updated:function(){this.toBottomSmooth()},beforeUnmount:function(){this.messageRead(this.access),this.updateActiveList(this.access)},components:{MessageContainer:C}};n("4f5a");I.render=u;t["default"]=I},ff65:function(e,t,n){}}]);
//# sourceMappingURL=chunk-20a683e3.6db3501f.js.map